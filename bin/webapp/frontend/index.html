<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>OctapusPrime - Security Automation Dashboard</title>
  <style>
    /* ===== CSS Custom Properties ===== */
    :root {
      --primary-bg: #0d0d0d;
      --secondary-bg: #1a1a1a;
      --tertiary-bg: #262626;
      --primary-text: #e6e6e6;
      --secondary-text: #bbb;
      --accent-color: #39ff14;
      --accent-shadow: 0 0 8px #39ff14;
      --border-color: #333;
      --font-mono: "Roboto Mono", "Courier New", monospace;
      --transition: all 0.3s ease;
      --glow-box-shadow: 0 0 12px rgba(57, 255, 20, 0.3);
      --error-color: #ff0033;
      --warning-color: #ffa500;
      --success-color: #00ff00;
    }

    /* ===== Reset & Base Styles ===== */
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    html, body {
      height: 100%;
      font-family: var(--font-mono);
      background: var(--primary-bg);
      color: var(--primary-text);
      overflow: hidden;
    }

    /* ===== Navigation Header ===== */
    .nav-header {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      height: 60px;
      background: var(--secondary-bg);
      border-bottom: 1px solid var(--border-color);
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 0 20px;
      z-index: 1000;
    }

    .nav-brand {
      color: var(--accent-color);
      text-decoration: none;
      font-size: 18px;
      font-weight: bold;
      text-shadow: var(--accent-shadow);
    }

    .nav-actions {
      display: flex;
      gap: 15px;
      align-items: center;
    }

    .nav-link {
      color: var(--secondary-text);
      text-decoration: none;
      font-size: 14px;
      padding: 8px 12px;
      border-radius: 4px;
      transition: var(--transition);
    }

    .nav-link:hover {
      color: var(--accent-color);
      background: var(--tertiary-bg);
    }

    /* ===== Status Indicator ===== */
    .status-indicator {
      display: flex;
      align-items: center;
      gap: 8px;
      font-size: 13px;
    }

    .status-dot {
      width: 8px;
      height: 8px;
      border-radius: 50%;
      background: var(--warning-color);
      animation: pulse 2s infinite;
    }

    .status-dot.connected {
      background: var(--success-color);
      animation: none;
    }

    @keyframes pulse {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.5; }
    }

    /* ===== Main Container ===== */
    .main-container {
      display: flex;
      height: 100vh;
      padding-top: 60px;
    }

    /* ===== Tool Palette Sidebar ===== */
    .tool-palette {
      width: 280px;
      background: var(--secondary-bg);
      border-right: 1px solid var(--border-color);
      display: flex;
      flex-direction: column;
      overflow-y: auto;
    }

    .palette-header {
      padding: 20px;
      border-bottom: 1px solid var(--border-color);
    }

    .palette-title {
      font-size: 18px;
      color: var(--accent-color);
      margin-bottom: 10px;
      text-shadow: var(--accent-shadow);
    }

    .palette-search {
      width: 100%;
      padding: 8px 12px;
      background: var(--tertiary-bg);
      border: 1px solid var(--border-color);
      border-radius: 6px;
      color: var(--primary-text);
      font-family: var(--font-mono);
      font-size: 13px;
    }

    .palette-search:focus {
      outline: none;
      border-color: var(--accent-color);
      box-shadow: var(--glow-box-shadow);
    }

    .palette-content {
      flex: 1;
      padding: 15px;
    }

    .tool-category {
      margin-bottom: 25px;
    }

    .category-title {
      font-size: 14px;
      color: var(--accent-color);
      margin-bottom: 12px;
      text-transform: uppercase;
      letter-spacing: 1px;
    }

    .tool-card {
      background: var(--tertiary-bg);
      border: 1px solid var(--border-color);
      border-radius: 8px;
      margin-bottom: 12px;
      padding: 15px;
      cursor: grab;
      transition: var(--transition);
      user-select: none;
    }

    .tool-card:hover {
      background: #2f2f2f;
      border-color: var(--accent-color);
      box-shadow: var(--glow-box-shadow);
      transform: translateY(-2px);
    }

    .tool-card:active {
      cursor: grabbing;
      transform: translateY(0);
    }

    .tool-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 8px;
    }

    .tool-name {
      font-weight: bold;
      color: var(--accent-color);
      font-size: 15px;
    }

    .tool-help-btn {
      background: none;
      border: none;
      color: var(--secondary-text);
      font-size: 12px;
      cursor: pointer;
      padding: 4px;
      border-radius: 3px;
      transition: var(--transition);
    }

    .tool-help-btn:hover {
      color: var(--accent-color);
      background: var(--secondary-bg);
    }

    .tool-description {
      color: var(--secondary-text);
      font-size: 12px;
      margin-bottom: 10px;
      line-height: 1.4;
    }

    .arg-palette {
      display: flex;
      flex-wrap: wrap;
      gap: 6px;
    }

    .arg-chip {
      background: var(--secondary-bg);
      border: 1px solid var(--border-color);
      border-radius: 12px;
      padding: 4px 8px;
      font-size: 11px;
      color: var(--primary-text);
      cursor: grab;
      transition: var(--transition);
    }

    .arg-chip:hover {
      background: var(--primary-bg);
      border-color: var(--accent-color);
      color: var(--accent-color);
    }

    .arg-chip:active {
      cursor: grabbing;
    }

    /* ===== Main Content Area ===== */
    .main-content {
      flex: 1;
      display: flex;
      flex-direction: column;
      padding: 20px;
      overflow: hidden;
    }

    .content-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
    }

    .content-title {
      font-size: 24px;
      color: var(--accent-color);
      text-shadow: var(--accent-shadow);
    }

    .quick-actions {
      display: flex;
      gap: 10px;
    }

    .btn {
      padding: 10px 16px;
      border: none;
      border-radius: 6px;
      font-family: var(--font-mono);
      font-size: 13px;
      cursor: pointer;
      transition: var(--transition);
      text-decoration: none;
      display: inline-block;
      text-align: center;
    }

    .btn-primary {
      background: var(--accent-color);
      color: var(--primary-bg);
      font-weight: bold;
    }

    .btn-primary:hover {
      background: #2ecc71;
      box-shadow: var(--glow-box-shadow);
      transform: translateY(-2px);
    }

    .btn-secondary {
      background: var(--tertiary-bg);
      color: var(--primary-text);
      border: 1px solid var(--border-color);
    }

    .btn-secondary:hover {
      background: #333;
      border-color: var(--accent-color);
    }

    .btn-danger {
      background: var(--error-color);
      color: white;
    }

    .btn-danger:hover {
      background: #e6002e;
      box-shadow: 0 0 12px rgba(255, 0, 51, 0.3);
    }

    .btn:disabled {
      opacity: 0.4;
      cursor: not-allowed;
      transform: none;
    }

    /* ===== Scenario Controls ===== */
    .scenario-controls {
      display: flex;
      gap: 12px;
      align-items: center;
      margin-bottom: 20px;
      padding: 15px;
      background: var(--secondary-bg);
      border: 1px solid var(--border-color);
      border-radius: 8px;
    }

    .scenario-input {
      flex: 1;
      padding: 8px 12px;
      background: var(--tertiary-bg);
      color: var(--primary-text);
      border: 1px solid var(--border-color);
      border-radius: 6px;
      font-family: var(--font-mono);
      font-size: 13px;
    }

    .scenario-input:focus {
      outline: none;
      border-color: var(--accent-color);
      box-shadow: var(--glow-box-shadow);
    }

    .scenario-select {
      background: var(--tertiary-bg);
      color: var(--primary-text);
      border: 1px solid var(--border-color);
      border-radius: 6px;
      padding: 8px 12px;
      font-family: var(--font-mono);
      font-size: 13px;
      min-width: 200px;
    }

    /* ===== Drop Zone ===== */
    .drop-zone {
      flex: 0 0 240px;
      margin-bottom: 20px;
      padding: 20px;
      background: var(--secondary-bg);
      border: 2px dashed var(--border-color);
      border-radius: 8px;
      overflow-y: auto;
      transition: var(--transition);
      position: relative;
    }

    .drop-zone.dragover {
      background: var(--tertiary-bg);
      border-color: var(--accent-color);
      box-shadow: var(--glow-box-shadow);
    }

    .drop-zone-placeholder {
      text-align: center;
      color: var(--secondary-text);
      font-style: italic;
      padding: 40px 20px;
    }

    .scheduled-item {
      background: var(--tertiary-bg);
      border: 1px solid var(--border-color);
      border-radius: 8px;
      margin-bottom: 12px;
      padding: 15px;
      display: flex;
      align-items: center;
      gap: 12px;
      animation: slideIn 0.3s ease-out;
    }

    @keyframes slideIn {
      from { opacity: 0; transform: translateX(-20px); }
      to { opacity: 1; transform: translateX(0); }
    }

    .scheduled-item:hover {
      border-color: var(--accent-color);
    }

    .item-icon {
      width: 40px;
      height: 40px;
      background: var(--accent-color);
      color: var(--primary-bg);
      border-radius: 6px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: bold;
      font-size: 14px;
      flex-shrink: 0;
    }

    .item-content {
      flex: 1;
      display: flex;
      flex-direction: column;
      gap: 8px;
    }

    .item-title {
      font-weight: bold;
      color: var(--accent-color);
      font-size: 14px;
    }

    .item-input {
      width: 100%;
      padding: 8px 12px;
      background: var(--primary-bg);
      color: var(--primary-text);
      border: 1px solid var(--border-color);
      border-radius: 6px;
      font-family: var(--font-mono);
      font-size: 12px;
    }

    .item-input:focus {
      outline: none;
      border-color: var(--accent-color);
    }

    .item-actions {
      display: flex;
      gap: 6px;
      flex-shrink: 0;
    }

    .item-btn {
      padding: 6px 8px;
      border: none;
      border-radius: 4px;
      font-size: 12px;
      cursor: pointer;
      transition: var(--transition);
    }

    .btn-remove {
      background: var(--error-color);
      color: white;
    }

    .btn-remove:hover {
      background: #e6002e;
    }

    /* ===== Output Section ===== */
    .output-section {
      flex: 1;
      display: flex;
      flex-direction: column;
      overflow: hidden;
    }

    .output-header {
      display: flex;
      justify-content: between;
      align-items: center;
      margin-bottom: 15px;
      padding-bottom: 10px;
      border-bottom: 1px solid var(--border-color);
    }

    .output-title {
      font-size: 18px;
      color: var(--accent-color);
    }

    .output-controls {
      display: flex;
      gap: 8px;
    }

    .output-container {
      flex: 1;
      overflow-y: auto;
      border: 1px solid var(--border-color);
      border-radius: 8px;
      background: var(--secondary-bg);
    }

    .output-card {
      border-bottom: 1px solid var(--border-color);
      animation: fadeIn 0.3s ease-out;
    }

    .output-card:last-child {
      border-bottom: none;
    }

    @keyframes fadeIn {
      from {
        opacity: 0;
        transform: translateY(10px);
      }

      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .card-header {
      background: var(--tertiary-bg);
      padding: 12px 16px;
      cursor: pointer;
      display: flex;
      justify-content: space-between;
      align-items: center;
      user-select: none;
      transition: var(--transition);
    }

    .card-header:hover {
      background: #2f2f2f;
    }

    .card-title {
      font-weight: bold;
      color: var(--accent-color);
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .tool-status {
      width: 8px;
      height: 8px;
      border-radius: 50%;
      background: var(--secondary-text);
    }

    .tool-status.running {
      background: var(--accent-color);
      animation: pulse 1s infinite;
    }

    .tool-status.complete {
      background: var(--success-color);
    }

    .tool-status.error {
      background: var(--error-color);
    }

    .card-toggle {
      background: none;
      border: none;
      color: var(--secondary-text);
      font-size: 16px;
      cursor: pointer;
      transition: var(--transition);
      transform: rotate(0deg);
    }

    .card-header.expanded .card-toggle {
      transform: rotate(90deg);
      color: var(--accent-color);
    }

    .card-body {
      max-height: 0;
      overflow: hidden;
      transition: max-height 0.3s ease;
      background: var(--primary-bg);
    }

    .card-body.expanded {
      max-height: 300px;
      overflow-y: auto;
    }

    .card-content {
      padding: 15px;
      font-family: 'Courier New', monospace;
      font-size: 12px;
      line-height: 1.4;
    }

    .log-line {
      color: var(--success-color);
      margin: 0;
      white-space: pre-wrap;
    }

    .log-line.error {
      color: var(--error-color);
    }

    .log-line.warning {
      color: var(--warning-color);
    }

    /* ===== Command Modal ===== */
    .modal {
      display: none;
      position: fixed;
      z-index: 2000;
      left: 0;
      top: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.8);
      backdrop-filter: blur(4px);
    }

    .modal-content {
      background: var(--secondary-bg);
      margin: 3% auto;
      padding: 0;
      border: 2px solid var(--accent-color);
      border-radius: 12px;
      width: 90%;
      max-width: 900px;
      max-height: 85vh;
      overflow: hidden;
      box-shadow: 0 0 30px rgba(57, 255, 20, 0.3);
    }

    .modal-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 20px 25px;
      background: var(--tertiary-bg);
      border-bottom: 1px solid var(--border-color);
    }

    .modal-title {
      color: var(--accent-color);
      font-size: 20px;
      font-weight: bold;
    }

    .modal-close {
      background: var(--error-color);
      color: white;
      border: none;
      border-radius: 6px;
      padding: 8px 12px;
      cursor: pointer;
      font-size: 16px;
      transition: var(--transition);
    }

    .modal-close:hover {
      background: #e6002e;
    }

    .modal-body {
      padding: 25px;
      max-height: 60vh;
      overflow-y: auto;
    }

    .command-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
      gap: 15px;
    }

    .command-item {
      background: var(--tertiary-bg);
      border: 1px solid var(--border-color);
      border-radius: 8px;
      padding: 15px;
      cursor: pointer;
      transition: var(--transition);
    }

    .command-item:hover {
      background: #2f2f2f;
      border-color: var(--accent-color);
      box-shadow: var(--glow-box-shadow);
      transform: translateY(-2px);
    }

    .command-cmd {
      color: var(--accent-color);
      font-weight: bold;
      margin-bottom: 8px;
      font-family: var(--font-mono);
    }

    .command-desc {
      color: var(--secondary-text);
      font-size: 13px;
      line-height: 1.4;
    }

    /* ===== Scrollbar Styling ===== */
    .tool-palette::-webkit-scrollbar,
    .drop-zone::-webkit-scrollbar,
    .output-container::-webkit-scrollbar,
    .card-body::-webkit-scrollbar,
    .modal-body::-webkit-scrollbar {
      width: 8px;
    }

    .tool-palette::-webkit-scrollbar-thumb,
    .drop-zone::-webkit-scrollbar-thumb,
    .output-container::-webkit-scrollbar-thumb,
    .card-body::-webkit-scrollbar-thumb,
    .modal-body::-webkit-scrollbar-thumb {
      background: var(--border-color);
      border-radius: 4px;
    }

    .tool-palette::-webkit-scrollbar-thumb:hover,
    .drop-zone::-webkit-scrollbar-thumb:hover,
    .output-container::-webkit-scrollbar-thumb:hover,
    .card-body::-webkit-scrollbar-thumb:hover,
    .modal-body::-webkit-scrollbar-thumb:hover {
      background: var(--accent-color);
    }

    /* ===== Responsive Design ===== */
    @media (max-width: 1024px) {
      .tool-palette {
        width: 250px;
      }
      
      .command-grid {
        grid-template-columns: repeat(auto-fill, minmax(240px, 1fr));
      }
    }

    @media (max-width: 768px) {
      .main-container {
        flex-direction: column;
      }
      
      .tool-palette {
        width: 100%;
        height: 300px;
      }
      
      .nav-actions {
        display: none;
      }
      
      .scenario-controls {
        flex-direction: column;
        gap: 10px;
      }
      
      .content-header {
        flex-direction: column;
        gap: 15px;
        align-items: flex-start;
      }
    }

    /* ===== Loading States ===== */
    .loading {
      opacity: 0.6;
      pointer-events: none;
    }

    .spinner {
      display: inline-block;
      width: 16px;
      height: 16px;
      border: 2px solid var(--border-color);
      border-radius: 50%;
      border-top-color: var(--accent-color);
      animation: spin 1s linear infinite;
    }

    @keyframes spin {
      to { transform: rotate(360deg); }
    }
  </style>
</head>
<body>
  <!-- Navigation Header -->
  <nav class="nav-header">
    <a href="/" class="nav-brand">OctapusPrime</a>
    <div class="nav-actions">
      <div class="status-indicator">
        <div class="status-dot" id="connection-status"></div>
        <span id="connection-text">Connecting...</span>
      </div>
      <a href="/demo" class="nav-link">Demo</a>
      <a href="/scenario_maker" class="nav-link">Scenario Builder</a>
      <a href="/settings" class="nav-link">Settings</a>
      <a href="/help" class="nav-link">Help</a>
    </div>
  </nav>

  <!-- Command Modal -->
  <div id="command-modal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h2 class="modal-title" id="modal-title">Tool Commands</h2>
        <button class="modal-close" onclick="closeModal()">&times;</button>
      </div>
      <div class="modal-body" id="modal-body">
        <!-- Commands will be populated here -->
      </div>
    </div>
  </div>

  <!-- Main Container -->
  <div class="main-container">
    <!-- Tool Palette Sidebar -->
    <aside class="tool-palette">
      <div class="palette-header">
        <h3 class="palette-title">Security Tools</h3>
        <input type="text" class="palette-search" id="tool-search" placeholder="Search tools...">
      </div>
      <div class="palette-content" id="tool-categories">
        <!-- Tool categories will be populated here -->
      </div>
    </aside>

    <!-- Main Content Area -->
    <main class="main-content">
      <!-- Content Header -->
      <div class="content-header">
        <h1 class="content-title">Security Automation Dashboard</h1>
        <div class="quick-actions">
          <button class="btn btn-secondary" id="detect-network-btn">Auto-Detect Network</button>
          <button class="btn btn-primary" id="start-scan-btn">Start Scan</button>
          <button class="btn btn-danger" id="stop-scan-btn" disabled>Stop Scan</button>
        </div>
      </div>

      <!-- Scenario Controls -->
      <div class="scenario-controls">
        <input type="text" class="scenario-input" id="scenario-name" placeholder="Enter scenario name...">
        <button class="btn btn-secondary" id="save-scenario-btn">Save Scenario</button>
        <select class="scenario-select" id="scenario-list">
          <option value="">-- Load Scenario --</option>
        </select>
        <button class="btn btn-secondary" id="clear-scenario-btn">Clear All</button>
      </div>

      <!-- Drop Zone -->
      <div class="drop-zone" id="drop-zone">
        <div class="drop-zone-placeholder" id="drop-placeholder">
          <h3>Drag Security Tools Here</h3>
          <p>Drag tools from the sidebar to create your scan sequence</p>
          <p><small>Double-click tools to see available commands</small></p>
        </div>
      </div>

      <!-- Output Section -->
      <div class="output-section">
        <div class="output-header">
          <h3 class="output-title">Live Tool Output</h3>
          <div class="output-controls">
            <button class="btn btn-secondary" id="clear-output-btn">Clear Output</button>
            <button class="btn btn-secondary" id="expand-all-btn">Expand All</button>
          </div>
        </div>
        <div class="output-container" id="output-container">
          <!-- Output cards will be dynamically added here -->
        </div>
      </div>
    </main>
  </div>

  <!-- Socket.IO for real-time communication -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.5.0/socket.io.min.js"></script>
  <script>
    // Application state
    const AppState = {
      socket: null,
      outputCards: {},
      isScanning: false,
      tools: {},
      scheduledTools: new Map()
    };

    // Tool categories and definitions
    const TOOL_CATEGORIES = {
      'Network Discovery': {
        nmap: {
          name: 'Nmap',
          description: 'Network exploration tool and security scanner',
          args: ['-sV', '-A', '-O', '-T4', '-p 1-1000', '-sS', '-sU', '--script vuln', '-oN output.txt']
        },
        masscan: {
          name: 'Masscan',
          description: 'Fast port scanner for large networks',
          args: ['-p1-65535', '--rate 1000', '--ping', '-e eth0', '--banners', '-oX output.xml']
        },
        zmap: {
          name: 'Zmap',
          description: 'Internet-wide network scanner',
          args: ['-p 80', '-B 10M', '-c 1000', '-o results.csv']
        }
      },
      'Web Application': {
        gobuster: {
          name: 'Gobuster',
          description: 'Directory/file & DNS busting tool',
          args: ['dir -u http://target', '-w /usr/share/wordlists/dirb/common.txt', '-x php,txt,html', '-t 50', '-s 200,204,301,302']
        },
        nikto: {
          name: 'Nikto',
          description: 'Web vulnerability scanner',
          args: ['-h http://target', '-Tuning x', '-Display V', '-ssl', '-port 443', '-output nikto.txt']
        },
        sqlmap: {
          name: 'SQLmap',
          description: 'SQL injection detection and exploitation',
          args: ['-u http://target?id=1', '--batch', '--level 5', '--risk 3', '--dbs', '--tables', '--dump']
        },
        ffuf: {
          name: 'FFUF',
          description: 'Fast web fuzzer written in Go',
          args: ['-u http://target/FUZZ', '-w /usr/share/wordlists/common.txt', '-t 100', '-mc 200,204,301,302', '-fc 404']
        },
        wpscan: {
          name: 'WPScan',
          description: 'WordPress security scanner',
          args: ['--url http://target/', '--enumerate p', '--enumerate u', '--enumerate t', '--api-token TOKEN']
        }
      },
      'Credential Testing': {
        hydra: {
          name: 'Hydra',
          description: 'Login cracker supporting numerous protocols',
          args: ['-l admin', '-P /usr/share/wordlists/rockyou.txt', '-t 4', 'ssh://target', 'ftp://target', '-f', '-V']
        },
        john: {
          name: 'John',
          description: 'Password cracker',
          args: ['--wordlist=/usr/share/wordlists/rockyou.txt', '--format=raw-md5', 'hashes.txt', '--rules', '--show']
        },
        hashcat: {
          name: 'Hashcat',
          description: 'Advanced password recovery',
          args: ['-m 0', '-a 0', 'hashes.txt wordlist.txt', '--force', '-O', '--show']
        }
      },
      'Network Analysis': {
        enum4linux: {
          name: 'Enum4Linux',
          description: 'SMB enumeration tool for Linux',
          args: ['-a', '-u user', '-p password', '-S', '-U', '-G']
        },
        nbtscan: {
          name: 'NBTSCAN',
          description: 'NetBIOS name network scanner',
          args: ['-r', '-v', '-s :', '-h', '-m']
        },
        sslscan: {
          name: 'SSLScan',
          description: 'SSL/TLS configuration scanner',
          args: ['--no-failed', '--show-supported', '--reuse', '--xml=ssl.xml', '--ipv4']
        }
      },
      'Information Gathering': {
        theharvester: {
          name: 'TheHarvester',
          description: 'E-mail, subdomain and people names harvester',
          args: ['-d example.com', '-b google', '-b bing', '-l 500', '-f results.xml']
        },
        amass: {
          name: 'AMASS',
          description: 'In-depth DNS enumeration and network mapping',
          args: ['enum -d example.com', '-active', '-passive', '-brute', '-o amass.txt', '-ip']
        },
        subfinder: {
          name: 'Subfinder',
          description: 'Subdomain discovery tool',
          args: ['-d example.com', '-silent', '-o subdomains.txt', '-all', '-t 10', '-v']
        },
        dnsenum: {
          name: 'DNSenum',
          description: 'DNS enumeration tool',
          args: ['example.com', '--threads 5', '--dnsserver 8.8.8.8', '--enum', '-f dns.txt']
        }
      }
    };

    // Command database for detailed help
    const TOOL_COMMANDS = {
      nmap: [
        { cmd: "-sV", desc: "Version detection" },
        { cmd: "-A", desc: "Aggressive scan (OS detection, version detection, script scanning)" },
        { cmd: "-O", desc: "OS detection" },
        { cmd: "-sS", desc: "TCP SYN scan (stealth)" },
        { cmd: "-sU", desc: "UDP scan" },
        { cmd: "-sC", desc: "Default script scan" },
        { cmd: "-T4", desc: "Timing template (aggressive)" },
        { cmd: "-T1", desc: "Timing template (slow/stealthy)" },
        { cmd: "-p 1-1000", desc: "Scan ports 1-1000" },
        { cmd: "-p-", desc: "Scan all 65535 ports" },
        { cmd: "--script vuln", desc: "Vulnerability detection scripts" },
        { cmd: "--script auth", desc: "Authentication bypass scripts" },
        { cmd: "-sn", desc: "Ping scan (no port scan)" },
        { cmd: "-Pn", desc: "Skip host discovery" },
        { cmd: "-oN output.txt", desc: "Normal output to file" },
        { cmd: "-oX output.xml", desc: "XML output to file" },
        { cmd: "-v", desc: "Verbose output" },
        { cmd: "--reason", desc: "Show reason for port state" }
      ],
      masscan: [
        { cmd: "-p1-65535", desc: "Scan all 65535 ports" },
        { cmd: "-p80,443,8080", desc: "Scan specific ports" },
        { cmd: "--rate 1000", desc: "Set packet transmission rate" },
        { cmd: "--rate 10000", desc: "Fast scan (10k packets/sec)" },
        { cmd: "--ping", desc: "ICMP ping sweep" },
        { cmd: "-e eth0", desc: "Specify network interface" },
        { cmd: "--banners", desc: "Grab service banners" },
        { cmd: "--source-port 40000", desc: "Use specific source port" },
        { cmd: "--max-rate 100000", desc: "Maximum transmission rate" },
        { cmd: "-oX output.xml", desc: "XML output format" },
        { cmd: "-oJ output.json", desc: "JSON output format" },
        { cmd: "--excludefile exclude.txt", desc: "Exclude IPs from file" },
        { cmd: "--include-file include.txt", desc: "Include IPs from file" },
        { cmd: "--top-ports 100", desc: "Scan top 100 ports" },
        { cmd: "--wait 0", desc: "Don't wait for responses" },
        { cmd: "--offline", desc: "Don't transmit packets" }
      ],
      gobuster: [
        { cmd: "dir -u http://target", desc: "Directory enumeration mode" },
        { cmd: "dns -d domain.com", desc: "DNS subdomain enumeration" },
        { cmd: "vhost -u http://target", desc: "Virtual host enumeration" },
        { cmd: "-w /usr/share/wordlists/dirb/common.txt", desc: "Common wordlist" },
        { cmd: "-w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt", desc: "Medium wordlist" },
        { cmd: "-x php,txt,html,js,css", desc: "File extensions to search" },
        { cmd: "-x asp,aspx,jsp,do", desc: "Web app extensions" },
        { cmd: "-t 50", desc: "Number of concurrent threads" },
        { cmd: "-t 10", desc: "Slower scan (10 threads)" },
        { cmd: "-s 200,204,301,302,307", desc: "HTTP status codes to show" },
        { cmd: "-b 404,403", desc: "HTTP status codes to hide" },
        { cmd: "-k", desc: "Skip SSL certificate verification" },
        { cmd: "-r", desc: "Follow redirects" },
        { cmd: "-f", desc: "Append / to directory names" },
        { cmd: "-e", desc: "Show extended output" },
        { cmd: "-q", desc: "Quiet mode" },
        { cmd: "-o output.txt", desc: "Save output to file" },
        { cmd: "-a 'Mozilla/5.0'", desc: "Set User-Agent string" },
        { cmd: "--timeout 10s", desc: "HTTP request timeout" }
      ],
      nikto: [
        { cmd: "-h http://target", desc: "Target host/URL" },
        { cmd: "-h https://target:8443", desc: "HTTPS target with custom port" },
        { cmd: "-Tuning x", desc: "All scan types" },
        { cmd: "-Tuning 1", desc: "Interesting files" },
        { cmd: "-Tuning 2", desc: "Misconfiguration" },
        { cmd: "-Tuning 3", desc: "Information disclosure" },
        { cmd: "-Tuning 4", desc: "Injection attacks" },
        { cmd: "-Tuning 5", desc: "Remote file retrieval" },
        { cmd: "-Tuning 6", desc: "Denial of service" },
        { cmd: "-Display V", desc: "Verbose display" },
        { cmd: "-Display 1", desc: "Show redirects" },
        { cmd: "-Display 2", desc: "Show cookies" },
        { cmd: "-ssl", desc: "Force SSL/HTTPS" },
        { cmd: "-port 443,8443", desc: "Specify ports" },
        { cmd: "-timeout 10", desc: "Request timeout" },
        { cmd: "-output nikto.txt", desc: "Save output to file" },
        { cmd: "-Format txt", desc: "Text output format" },
        { cmd: "-Format xml", desc: "XML output format" },
        { cmd: "-useragent 'Custom Agent'", desc: "Custom User-Agent" },
        { cmd: "-id user:pass", desc: "HTTP authentication" }
      ],
      sqlmap: [
        { cmd: "-u 'http://target?id=1'", desc: "Target URL with parameter" },
        { cmd: "-r request.txt", desc: "Load request from file" },
        { cmd: "--data 'id=1&name=test'", desc: "POST data" },
        { cmd: "--cookie 'PHPSESSID=abc123'", desc: "HTTP cookies" },
        { cmd: "--batch", desc: "Non-interactive mode" },
        { cmd: "--level 5", desc: "Test level (1-5)" },
        { cmd: "--risk 3", desc: "Risk level (1-3)" },
        { cmd: "--dbs", desc: "Enumerate databases" },
        { cmd: "--tables", desc: "Enumerate tables" },
        { cmd: "--columns", desc: "Enumerate columns" },
        { cmd: "--dump", desc: "Dump table data" },
        { cmd: "--dump-all", desc: "Dump all databases" },
        { cmd: "-D database", desc: "Target specific database" },
        { cmd: "-T table", desc: "Target specific table" },
        { cmd: "-C column", desc: "Target specific column" },
        { cmd: "--os-shell", desc: "Interactive OS shell" },
        { cmd: "--sql-shell", desc: "Interactive SQL shell" },
        { cmd: "--technique B", desc: "Boolean-based blind" },
        { cmd: "--technique T", desc: "Time-based blind" },
        { cmd: "--technique U", desc: "Union query" },
        { cmd: "--random-agent", desc: "Random User-Agent" },
        { cmd: "--threads 5", desc: "Number of threads" },
        { cmd: "--delay 1", desc: "Delay between requests" }
      ],
      hydra: [
        { cmd: "-l admin", desc: "Single username" },
        { cmd: "-L users.txt", desc: "Username list from file" },
        { cmd: "-p password", desc: "Single password" },
        { cmd: "-P /usr/share/wordlists/rockyou.txt", desc: "Password list (rockyou)" },
        { cmd: "-P /usr/share/wordlists/fasttrack.txt", desc: "Password list (fasttrack)" },
        { cmd: "-t 4", desc: "Number of parallel tasks" },
        { cmd: "-t 16", desc: "Aggressive parallel tasks" },
        { cmd: "ssh://target", desc: "SSH brute force" },
        { cmd: "ftp://target", desc: "FTP brute force" },
        { cmd: "http-post-form://target/login.php", desc: "HTTP POST form" },
        { cmd: "http-get://target/admin", desc: "HTTP Basic Auth" },
        { cmd: "rdp://target", desc: "RDP brute force" },
        { cmd: "smb://target", desc: "SMB brute force" },
        { cmd: "-f", desc: "Stop after first success" },
        { cmd: "-F", desc: "Stop after first success per host" },
        { cmd: "-V", desc: "Verbose output" },
        { cmd: "-v", desc: "Show login attempts" },
        { cmd: "-s 2222", desc: "Custom port" },
        { cmd: "-o results.txt", desc: "Save output to file" },
        { cmd: "-R", desc: "Restore previous session" },
        { cmd: "-I", desc: "Ignore restore file" }
      ],
      sslscan: [
        { cmd: "--targets=target", desc: "Single target" },
        { cmd: "--no-failed", desc: "Hide failed cipher tests" },
        { cmd: "--show-supported", desc: "Show supported ciphers only" },
        { cmd: "--show-client-cas", desc: "Show client certificate CAs" },
        { cmd: "--show-ciphers", desc: "Show cipher details" },
        { cmd: "--show-certificate", desc: "Show certificate details" },
        { cmd: "--check-certs", desc: "Check certificate chain" },
        { cmd: "--pk", desc: "Show public key details" },
        { cmd: "--bugs", desc: "Test for SSL bugs" },
        { cmd: "--heartbleed", desc: "Test for Heartbleed" },
        { cmd: "--reuse", desc: "Test SSL session reuse" },
        { cmd: "--compression", desc: "Test SSL compression" },
        { cmd: "--renegotiation", desc: "Test renegotiation" },
        { cmd: "--starttls-smtp", desc: "SMTP STARTTLS" },
        { cmd: "--starttls-pop3", desc: "POP3 STARTTLS" },
        { cmd: "--starttls-imap", desc: "IMAP STARTTLS" },
        { cmd: "--starttls-ftp", desc: "FTP STARTTLS" },
        { cmd: "--xml=ssl.xml", desc: "XML output file" },
        { cmd: "--ipv4", desc: "Force IPv4" },
        { cmd: "--ipv6", desc: "Force IPv6" }
      ],
      dirsearch: [
        { cmd: "-u http://target/", desc: "Target URL" },
        { cmd: "-u https://target:8443/", desc: "HTTPS with custom port" },
        { cmd: "-e php,html,js,txt,xml", desc: "File extensions" },
        { cmd: "-e asp,aspx,jsp,do", desc: "Web app extensions" },
        { cmd: "-w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt", desc: "Custom wordlist" },
        { cmd: "-x 400,403,404,500", desc: "Exclude status codes" },
        { cmd: "-i 200,301,302", desc: "Include status codes" },
        { cmd: "-t 50", desc: "Number of threads" },
        { cmd: "-t 10", desc: "Slower scan" },
        { cmd: "--recursive", desc: "Recursive directory search" },
        { cmd: "--deep-recursive", desc: "Deep recursive search" },
        { cmd: "--force-recursive", desc: "Force recursive on all dirs" },
        { cmd: "--subdirs=admin,backup", desc: "Scan subdirectories" },
        { cmd: "--random-agent", desc: "Random User-Agent" },
        { cmd: "--user-agent='Custom'", desc: "Custom User-Agent" },
        { cmd: "--cookie='session=123'", desc: "HTTP cookies" },
        { cmd: "--header='Authorization: Bearer token'", desc: "Custom headers" },
        { cmd: "--timeout=30", desc: "Request timeout" },
        { cmd: "--delay=1", desc: "Delay between requests" },
        { cmd: "-o report.txt", desc: "Save output to file" }
      ],
      enum4linux: [
        { cmd: "-a", desc: "All simple enumeration" },
        { cmd: "-U", desc: "Get userlist" },
        { cmd: "-M", desc: "Get machine list" },
        { cmd: "-N", desc: "Get namelist dump" },
        { cmd: "-S", desc: "Get sharelist" },
        { cmd: "-P", desc: "Get password policy" },
        { cmd: "-G", desc: "Get group and member list" },
        { cmd: "-d", desc: "Dictionary attack" },
        { cmd: "-u user", desc: "Specify username" },
        { cmd: "-p password", desc: "Specify password" },
        { cmd: "-k user", desc: "User to authenticate with" },
        { cmd: "-l", desc: "Get limited info via LDAP" },
        { cmd: "-r", desc: "Enumerate via RPC" },
        { cmd: "-R 500-550", desc: "RID cycling range" },
        { cmd: "-s /usr/share/enum4linux/share-list.txt", desc: "Share list file" },
        { cmd: "-v", desc: "Verbose output" },
        { cmd: "-w workgroup", desc: "Specify workgroup" },
        { cmd: "-o", desc: "Get OS information" }
      ],
      nbtscan: [
        { cmd: "-r", desc: "Use local port 137 for scans" },
        { cmd: "-v", desc: "Verbose output" },
        { cmd: "-s :", desc: "Separator character" },
        { cmd: "-h", desc: "Print human readable names" },
        { cmd: "-m", desc: "Include MAC address" },
        { cmd: "-T timeout", desc: "Timeout in seconds" },
        { cmd: "-f filename", desc: "Read targets from file" },
        { cmd: "-q", desc: "Suppress banner" },
        { cmd: "-n", desc: "Turn off inverse name lookup" },
        { cmd: "-p port", desc: "Use custom port" },
        { cmd: "192.168.1.0/24", desc: "Scan network range" },
        { cmd: "192.168.1.1-254", desc: "Scan IP range" }
      ],
      theharvester: [
        { cmd: "-d example.com", desc: "Target domain" },
        { cmd: "-b google", desc: "Google search engine" },
        { cmd: "-b bing", desc: "Bing search engine" },
        { cmd: "-b linkedin", desc: "LinkedIn search" },
        { cmd: "-b twitter", desc: "Twitter search" },
        { cmd: "-b all", desc: "All search engines" },
        { cmd: "-l 500", desc: "Limit results to 500" },
        { cmd: "-l 100", desc: "Limit results to 100" },
        { cmd: "-s 100", desc: "Start at result 100" },
        { cmd: "-f results.xml", desc: "Save to XML file" },
        { cmd: "-f results.html", desc: "Save to HTML file" },
        { cmd: "-n", desc: "Perform DNS reverse lookup" },
        { cmd: "-c", desc: "Perform DNS brute force" },
        { cmd: "-t", desc: "Perform DNS TLD expansion" },
        { cmd: "-e dns.txt", desc: "DNS brute force wordlist" },
        { cmd: "-v", desc: "Verify hostnames via DNS" },
        { cmd: "-p", desc: "Perform port scan" }
      ],
      wpscan: [
        { cmd: "--url http://target/", desc: "WordPress target URL" },
        { cmd: "--url https://target/wp/", desc: "WordPress in subdirectory" },
        { cmd: "--enumerate p", desc: "Enumerate plugins" },
        { cmd: "--enumerate t", desc: "Enumerate themes" },
        { cmd: "--enumerate u", desc: "Enumerate users" },
        { cmd: "--enumerate vp", desc: "Vulnerable plugins" },
        { cmd: "--enumerate vt", desc: "Vulnerable themes" },
        { cmd: "--enumerate cb", desc: "Config backups" },
        { cmd: "--enumerate dbe", desc: "Database exports" },
        { cmd: "--passwords /usr/share/wordlists/rockyou.txt", desc: "Password attack" },
        { cmd: "--usernames admin,user", desc: "Specific usernames" },
        { cmd: "--api-token TOKEN", desc: "WPScan API token" },
        { cmd: "--force", desc: "Force scan even if not WordPress" },
        { cmd: "--update", desc: "Update vulnerability database" },
        { cmd: "--random-user-agent", desc: "Random User-Agent" },
        { cmd: "--throttle 500", desc: "Milliseconds between requests" },
        { cmd: "--max-threads 5", desc: "Maximum threads" },
        { cmd: "-o wpscan.txt", desc: "Output to file" },
        { cmd: "--format cli", desc: "CLI output format" },
        { cmd: "--format json", desc: "JSON output format" }
      ],
      ffuf: [
        { cmd: "-u http://target/FUZZ", desc: "URL with FUZZ keyword" },
        { cmd: "-u http://FUZZ.target.com/", desc: "Subdomain fuzzing" },
        { cmd: "-u http://target/FUZZ.php", desc: "File extension fuzzing" },
        { cmd: "-w /usr/share/wordlists/dirb/common.txt", desc: "Common wordlist" },
        { cmd: "-w /usr/share/wordlists/SecLists/Discovery/Web-Content/directory-list-2.3-medium.txt", desc: "Medium wordlist" },
        { cmd: "-w subdomains.txt:FUZZ", desc: "Custom wordlist with keyword" },
        { cmd: "-t 100", desc: "Number of threads" },
        { cmd: "-t 25", desc: "Slower scan" },
        { cmd: "-rate 100", desc: "Requests per second" },
        { cmd: "-mc 200,204,301,302,307", desc: "Match HTTP codes" },
        { cmd: "-fc 404,403", desc: "Filter HTTP codes" },
        { cmd: "-ms 1000", desc: "Match response size" },
        { cmd: "-fs 1337", desc: "Filter response size" },
        { cmd: "-mr 'admin'", desc: "Match response text" },
        { cmd: "-fr 'not found'", desc: "Filter response text" },
        { cmd: "-H 'Authorization: Bearer token'", desc: "Custom headers" },
        { cmd: "-b 'session=abc123'", desc: "HTTP cookies" },
        { cmd: "-d 'user=admin&pass=FUZZ'", desc: "POST data fuzzing" },
        { cmd: "-recursion", desc: "Recursive fuzzing" },
        { cmd: "-recursion-depth 2", desc: "Recursion depth" },
        { cmd: "-o ffuf.json", desc: "JSON output" },
        { cmd: "-of html", desc: "HTML output format" },
        { cmd: "-s", desc: "Silent mode" },
        { cmd: "-v", desc: "Verbose output" }
      ],
      amass: [
        { cmd: "enum -d example.com", desc: "Basic domain enumeration" },
        { cmd: "enum -d example.com -active", desc: "Active reconnaissance" },
        { cmd: "enum -d example.com -passive", desc: "Passive reconnaissance only" },
        { cmd: "enum -d example.com -brute", desc: "Brute force subdomains" },
        { cmd: "enum -df domains.txt", desc: "Multiple domains from file" },
        { cmd: "enum -d example.com -src", desc: "Show data sources" },
        { cmd: "enum -d example.com -ip", desc: "Show IP addresses" },
        { cmd: "enum -d example.com -dir /tmp/amass", desc: "Output directory" },
        { cmd: "enum -d example.com -config config.ini", desc: "Configuration file" },
        { cmd: "enum -d example.com -o amass.txt", desc: "Output to file" },
        { cmd: "enum -d example.com -json amass.json", desc: "JSON output" },
        { cmd: "enum -d example.com -timeout 30", desc: "DNS timeout" },
        { cmd: "enum -d example.com -max-dns-queries 1000", desc: "Max DNS queries" },
        { cmd: "viz -d3 -d example.com", desc: "D3.js visualization" },
        { cmd: "viz -gexf -d example.com", desc: "GEXF file output" },
        { cmd: "db -names", desc: "Show database names" },
        { cmd: "db -d example.com -show", desc: "Show database contents" }
      ],
      dnsenum: [
        { cmd: "example.com", desc: "Basic domain enumeration" },
        { cmd: "--threads 5", desc: "Number of threads" },
        { cmd: "--threads 10", desc: "More aggressive threading" },
        { cmd: "--dnsserver 8.8.8.8", desc: "Custom DNS server" },
        { cmd: "--dnsserver 1.1.1.1", desc: "Cloudflare DNS" },
        { cmd: "--enum", desc: "Shortcut for common enums" },
        { cmd: "--subfile subdomains.txt", desc: "Subdomain wordlist" },
        { cmd: "--timeout 10", desc: "Timeout in seconds" },
        { cmd: "--retry 3", desc: "Number of retries" },
        { cmd: "-p", desc: "Pages of Google results" },
        { cmd: "-s 15", desc: "Scrape Google results" },
        { cmd: "-f dns.txt", desc: "Output file" },
        { cmd: "-u a,mx,ns", desc: "Update zone data" },
        { cmd: "-r", desc: "Enable reverse lookup" },
        { cmd: "-d", desc: "Calculate C class ranges" },
        { cmd: "-o", desc: "Show nslookup info" },
        { cmd: "-w", desc: "Enable whois queries" },
        { cmd: "-v", desc: "Verbose output" }
      ],
      subfinder: [
        { cmd: "-d example.com", desc: "Target domain" },
        { cmd: "-dL domains.txt", desc: "Multiple domains from file" },
        { cmd: "-silent", desc: "Silent mode (results only)" },
        { cmd: "-v", desc: "Verbose output" },
        { cmd: "-o subdomains.txt", desc: "Output to file" },
        { cmd: "-oJ", desc: "JSON output" },
        { cmd: "-all", desc: "Use all sources" },
        { cmd: "-sources", desc: "List available sources" },
        { cmd: "-exclude-sources source1,source2", desc: "Exclude specific sources" },
        { cmd: "-max-time 10", desc: "Maximum enumeration time" },
        { cmd: "-t 10", desc: "Number of concurrent goroutines" },
        { cmd: "-timeout 30", desc: "HTTP timeout" },
        { cmd: "-nW", desc: "Remove wildcard responses" },
        { cmd: "-rL resolvers.txt", desc: "Custom DNS resolvers" },
        { cmd: "-config config.yaml", desc: "Configuration file" },
        { cmd: "-recursive", desc: "Recursive subdomain discovery" },
        { cmd: "-active", desc: "Active DNS resolution" }
      ],
      john: [
        { cmd: "--wordlist=/usr/share/wordlists/rockyou.txt", desc: "Use rockyou wordlist" },
        { cmd: "--wordlist=/usr/share/wordlists/fasttrack.txt", desc: "Use fasttrack wordlist" },
        { cmd: "--format=raw-md5", desc: "MD5 hash format" },
        { cmd: "--format=raw-sha1", desc: "SHA1 hash format" },
        { cmd: "--format=bcrypt", desc: "bcrypt hash format" },
        { cmd: "--format=NT", desc: "Windows NTLM format" },
        { cmd: "hashes.txt", desc: "Hash file" },
        { cmd: "--rules", desc: "Apply word mangling rules" },
        { cmd: "--rules=wordlist", desc: "Specific rule set" },
        { cmd: "--incremental", desc: "Incremental mode (brute force)" },
        { cmd: "--incremental=alpha", desc: "Alpha incremental mode" },
        { cmd: "--show", desc: "Show cracked passwords" },
        { cmd: "--show=left", desc: "Show uncracked hashes" },
        { cmd: "--session=name", desc: "Named session" },
        { cmd: "--restore=name", desc: "Restore session" },
        { cmd: "--fork=4", desc: "Parallel processing" },
        { cmd: "--max-run-time=3600", desc: "Maximum runtime (seconds)" },
        { cmd: "--progress-every=30", desc: "Progress interval" }
      ],
      hashcat: [
        { cmd: "-m 0", desc: "MD5 hash mode" },
        { cmd: "-m 100", desc: "SHA1 hash mode" },
        { cmd: "-m 1400", desc: "SHA256 hash mode" },
        { cmd: "-m 1000", desc: "NTLM hash mode" },
        { cmd: "-m 3200", desc: "bcrypt hash mode" },
        { cmd: "-a 0", desc: "Dictionary attack" },
        { cmd: "-a 1", desc: "Combination attack" },
        { cmd: "-a 3", desc: "Brute force attack" },
        { cmd: "hashes.txt wordlist.txt", desc: "Hash and wordlist files" },
        { cmd: "hashes.txt /usr/share/wordlists/rockyou.txt", desc: "Use rockyou wordlist" },
        { cmd: "--force", desc: "Ignore warnings" },
        { cmd: "-O", desc: "Optimized kernels" },
        { cmd: "-w 3", desc: "Workload profile (high)" },
        { cmd: "-w 1", desc: "Workload profile (low)" },
        { cmd: "--show", desc: "Show cracked passwords" },
        { cmd: "--left", desc: "Show uncracked hashes" },
        { cmd: "-r rules/best64.rule", desc: "Apply rules" },
        { cmd: "--increment", desc: "Incremental mode" },
        { cmd: "--increment-min=4", desc: "Minimum length" },
        { cmd: "--increment-max=8", desc: "Maximum length" },
        { cmd: "-o cracked.txt", desc: "Output file" },
        { cmd: "--outfile-format=2", desc: "Output format (hash:plain)" },
        { cmd: "--status", desc: "Show status" },
        { cmd: "--status-timer=60", desc: "Status interval" }
      ],
      macchanger: [
        { cmd: "Usage: macchanger [options] device", desc: "Command usage" },
        { cmd: "-r", desc: "Set a random MAC address" },
        { cmd: "-m XX:XX:XX:XX:XX:XX", desc: "Set a specific MAC address" },
        { cmd: "-s", desc: "Show the current MAC address" },
        { cmd: "-l", desc: "List known vendors" },
        { cmd: "-e", desc: "Set MAC to match vendor" },
        { cmd: "-a", desc: "Set random MAC of same vendor type" },
        { cmd: "-A", desc: "Set random MAC of any vendor type" },
        { cmd: "-p", desc: "Preserve current MAC address" },
        { cmd: "-u", desc: "Restore the original MAC address" },
        { cmd: "eth0", desc: "Example network interface" }
      ]
    };

    // Initialize application
    document.addEventListener('DOMContentLoaded', () => {
      initializeApp();
    });

    function initializeApp() {
      initializeSocket();
      renderToolPalette();
      setupEventListeners();
      loadScenarios();
    }

    // Socket.IO initialization
    function initializeSocket() {
      AppState.socket = io();
      
      AppState.socket.on('connect', () => {
        updateConnectionStatus(true);
      });

      AppState.socket.on('disconnect', () => {
        updateConnectionStatus(false);
      });

      AppState.socket.on('log', (data) => {
        handleLogMessage(data);
      });

      AppState.socket.on('scan_complete', (data) => {
        handleScanComplete(data);
      });
    }

    function updateConnectionStatus(connected) {
      const statusDot = document.getElementById('connection-status');
      const statusText = document.getElementById('connection-text');
      
      if (connected) {
        statusDot.classList.add('connected');
        statusText.textContent = 'Connected';
      } else {
        statusDot.classList.remove('connected');
        statusText.textContent = 'Disconnected';
      }
    }

    // Render tool palette
    function renderToolPalette() {
      const container = document.getElementById('tool-categories');
      container.innerHTML = '';

      Object.entries(TOOL_CATEGORIES).forEach(([category, tools]) => {
        const categoryDiv = document.createElement('div');
        categoryDiv.className = 'tool-category';
        
        const categoryTitle = document.createElement('h4');
        categoryTitle.className = 'category-title';
        categoryTitle.textContent = category;
        categoryDiv.appendChild(categoryTitle);

        Object.entries(tools).forEach(([toolKey, tool]) => {
          const toolCard = createToolCard(toolKey, tool);
          categoryDiv.appendChild(toolCard);
        });

        container.appendChild(categoryDiv);
      });
    }

    function createToolCard(toolKey, tool) {
      const card = document.createElement('div');
      card.className = 'tool-card';
      card.draggable = true;
      card.dataset.tool = toolKey;

      const header = document.createElement('div');
      header.className = 'tool-header';
      
      const name = document.createElement('div');
      name.className = 'tool-name';
      name.textContent = tool.name;
      
      const helpBtn = document.createElement('button');
      helpBtn.className = 'tool-help-btn';
      helpBtn.textContent = '?';
      helpBtn.title = 'Show commands';
      helpBtn.onclick = (e) => {
        e.stopPropagation();
        showCommandModal(toolKey);
      };

      header.appendChild(name);
      header.appendChild(helpBtn);

      const description = document.createElement('div');
      description.className = 'tool-description';
      description.textContent = tool.description;

      const argPalette = document.createElement('div');
      argPalette.className = 'arg-palette';
      
      tool.args.slice(0, 6).forEach(arg => {
        const chip = document.createElement('div');
        chip.className = 'arg-chip';
        chip.textContent = arg;
        chip.draggable = true;
        chip.dataset.arg = arg;
        chip.dataset.tool = toolKey;
        argPalette.appendChild(chip);
      });

      card.appendChild(header);
      card.appendChild(description);
      card.appendChild(argPalette);

      // Add drag event listeners
      setupDragEvents(card, toolKey);

      return card;
    }

    // Setup drag and drop
    function setupDragEvents(element, toolKey) {
      element.addEventListener('dragstart', (e) => {
        e.dataTransfer.setData('text/plain', toolKey);
      });

      // Handle argument chip dragging
      element.querySelectorAll('.arg-chip').forEach(chip => {
        chip.addEventListener('dragstart', (e) => {
          e.stopPropagation();
          e.dataTransfer.setData('application/json', JSON.stringify({
            tool: chip.dataset.tool,
            arg: chip.dataset.arg
          }));
        });
      });

      // Double-click to show commands
      element.addEventListener('dblclick', () => {
        showCommandModal(toolKey);
      });
    }

    // Setup drop zone
    function setupDropZone() {
      const dropZone = document.getElementById('drop-zone');
      
      dropZone.addEventListener('dragover', (e) => {
        e.preventDefault();
        dropZone.classList.add('dragover');
      });

      dropZone.addEventListener('dragleave', () => {
        dropZone.classList.remove('dragover');
      });

      dropZone.addEventListener('drop', (e) => {
        e.preventDefault();
        dropZone.classList.remove('dragover');
        
        let data;
        try {
          // Try to parse as argument data
          data = JSON.parse(e.dataTransfer.getData('application/json'));
          addArgumentToTool(data.tool, data.arg);
        } catch {
          // Handle as tool name
          const toolName = e.dataTransfer.getData('text/plain');
          if (toolName) {
            addScheduledTool(toolName);
          }
        }
      });
    }

    // Add scheduled tool
    function addScheduledTool(toolKey) {
      if (AppState.scheduledTools.has(toolKey)) {
        return; // Tool already added
      }

      const tool = findToolByKey(toolKey);
      if (!tool) return;

      const placeholder = document.getElementById('drop-placeholder');
      if (placeholder) {
        placeholder.style.display = 'none';
      }

      const item = createScheduledItem(toolKey, tool);
      document.getElementById('drop-zone').appendChild(item);
      
      AppState.scheduledTools.set(toolKey, {
        tool: toolKey,
        args: []
      });

      // Create output card
      createOutputCard(toolKey);
    }

    function createScheduledItem(toolKey, tool) {
      const item = document.createElement('div');
      item.className = 'scheduled-item';
      item.dataset.tool = toolKey;

      const icon = document.createElement('div');
      icon.className = 'item-icon';
      icon.textContent = tool.name.charAt(0).toUpperCase();

      const content = document.createElement('div');
      content.className = 'item-content';

      const title = document.createElement('div');
      title.className = 'item-title';
      title.textContent = tool.name;

      const input = document.createElement('input');
      input.className = 'item-input';
      input.type = 'text';
      input.placeholder = 'Enter command arguments...';
      input.value = tool.args.slice(0, 3).join(' '); // Default args

      content.appendChild(title);
      content.appendChild(input);

      const actions = document.createElement('div');
      actions.className = 'item-actions';

      const removeBtn = document.createElement('button');
      removeBtn.className = 'item-btn btn-remove';
      removeBtn.textContent = '×';
      removeBtn.onclick = () => removeScheduledTool(toolKey);

      actions.appendChild(removeBtn);

      item.appendChild(icon);
      item.appendChild(content);
      item.appendChild(actions);

      return item;
    }

    function removeScheduledTool(toolKey) {
      const item = document.querySelector(`[data-tool="${toolKey}"]`);
      if (item) {
        item.remove();
      }

      AppState.scheduledTools.delete(toolKey);

      // Remove output card
      if (AppState.outputCards[toolKey]) {
        AppState.outputCards[toolKey].remove();
        delete AppState.outputCards[toolKey];
      }

      // Show placeholder if no tools
      if (AppState.scheduledTools.size === 0) {
        document.getElementById('drop-placeholder').style.display = 'block';
      }
    }

    function addArgumentToTool(toolKey, arg) {
      const item = document.querySelector(`.scheduled-item[data-tool="${toolKey}"]`);
      if (!item) {
        addScheduledTool(toolKey);
        return addArgumentToTool(toolKey, arg);
      }

      const input = item.querySelector('.item-input');
      const current = input.value.trim();
      if (!current.includes(arg)) {
        input.value = current ? `${current} ${arg}` : arg;
      }
    }

    // Output cards management
    function createOutputCard(toolKey) {
      if (AppState.outputCards[toolKey]) {
        return AppState.outputCards[toolKey];
      }

      const tool = findToolByKey(toolKey);
      const card = document.createElement('div');
      card.className = 'output-card';
      card.dataset.tool = toolKey;

      const header = document.createElement('div');
      header.className = 'card-header';
      
      const title = document.createElement('div');
      title.className = 'card-title';
      title.innerHTML = `
        <div class="tool-status" id="status-${toolKey}"></div>
        ${tool.name} Output
      `;

      const toggle = document.createElement('button');
      toggle.className = 'card-toggle';
      toggle.textContent = '▶';

      header.appendChild(title);
      header.appendChild(toggle);

      const body = document.createElement('div');
      body.className = 'card-body';

      const content = document.createElement('div');
      content.className = 'card-content';
      body.appendChild(content);

      card.appendChild(header);
      card.appendChild(body);

      // Toggle functionality
      header.addEventListener('click', () => {
        const expanded = body.classList.toggle('expanded');
        header.classList.toggle('expanded', expanded);
        toggle.textContent = expanded ? '▼' : '▶';
        
        if (expanded) {
          body.scrollTop = body.scrollHeight;
        }
      });

      document.getElementById('output-container').appendChild(card);
      AppState.outputCards[toolKey] = card;

      return card;
    }

    function handleLogMessage(data) {
      const { tool, line } = data;
      if (!AppState.outputCards[tool]) return;

      const content = AppState.outputCards[tool].querySelector('.card-content');
      const logLine = document.createElement('div');
      logLine.className = 'log-line';
      
      // Color code different types of output
      if (line.includes('ERROR') || line.includes('FAILED')) {
        logLine.classList.add('error');
      } else if (line.includes('WARNING') || line.includes('WARN')) {
        logLine.classList.add('warning');
      }
      
      logLine.textContent = line;
      content.appendChild(logLine);

      // Auto-scroll if expanded
      const body = AppState.outputCards[tool].querySelector('.card-body');
      if (body.classList.contains('expanded')) {
        body.scrollTop = body.scrollHeight;
      }

      // Update tool status
      updateToolStatus(tool, 'running');
    }

    function updateToolStatus(toolKey, status) {
      const statusElement = document.getElementById(`status-${toolKey}`);
      if (statusElement) {
        statusElement.className = `tool-status ${status}`;
      }
    }

    function handleScanComplete(data) {
      const { tool, success } = data;
      updateToolStatus(tool, success ? 'complete' : 'error');
    }

    // Modal functionality
    function showCommandModal(toolKey) {
      const modal = document.getElementById('command-modal');
      const title = document.getElementById('modal-title');
      const body = document.getElementById('modal-body');
      
      const tool = findToolByKey(toolKey);
      title.textContent = `${tool.name} Commands`;
      
      const commands = TOOL_COMMANDS[toolKey] || [];
      if (commands.length === 0) {
        body.innerHTML = '<p>No detailed commands available for this tool yet.</p>';
      } else {
        const grid = document.createElement('div');
        grid.className = 'command-grid';
        
        commands.forEach(command => {
          const item = document.createElement('div');
          item.className = 'command-item';
          item.innerHTML = `
            <div class="command-cmd">${command.cmd}</div>
            <div class="command-desc">${command.desc}</div>
          `;
          item.addEventListener('click', () => {
            addArgumentToTool(toolKey, command.cmd);
            closeModal();
          });
          grid.appendChild(item);
        });
        
        body.innerHTML = '';
        body.appendChild(grid);
      }
      
      modal.style.display = 'block';
    }

    function closeModal() {
      document.getElementById('command-modal').style.display = 'none';
    }

    // Event listeners setup
    function setupEventListeners() {
      setupDropZone();

      // Tool search
      document.getElementById('tool-search').addEventListener('input', (e) => {
        filterTools(e.target.value);
      });

      // Scan controls
      document.getElementById('start-scan-btn').addEventListener('click', startScan);
      document.getElementById('stop-scan-btn').addEventListener('click', stopScan);
      document.getElementById('detect-network-btn').addEventListener('click', detectNetwork);

      // Scenario controls
      document.getElementById('save-scenario-btn').addEventListener('click', saveScenario);
      document.getElementById('scenario-list').addEventListener('change', loadScenario);
      document.getElementById('clear-scenario-btn').addEventListener('click', clearAllTools);

      // Output controls
      document.getElementById('clear-output-btn').addEventListener('click', clearAllOutput);
      document.getElementById('expand-all-btn').addEventListener('click', expandAllOutput);

      // Modal close
      window.addEventListener('click', (e) => {
        const modal = document.getElementById('command-modal');
        if (e.target === modal) {
          closeModal();
        }
      });
    }

    // Utility functions
    function findToolByKey(toolKey) {
      for (const category of Object.values(TOOL_CATEGORIES)) {
        if (category[toolKey]) {
          return category[toolKey];
        }
      }
      return null;
    }

    function filterTools(searchTerm) {
      const toolCards = document.querySelectorAll('.tool-card');
      const categories = document.querySelectorAll('.tool-category');
      
      toolCards.forEach(card => {
        const toolName = card.querySelector('.tool-name').textContent.toLowerCase();
        const toolDesc = card.querySelector('.tool-description').textContent.toLowerCase();
        const matches = toolName.includes(searchTerm.toLowerCase()) || 
                       toolDesc.includes(searchTerm.toLowerCase());
        
        card.style.display = matches ? 'block' : 'none';
      });

      // Hide empty categories
      categories.forEach(category => {
        const visibleTools = category.querySelectorAll('.tool-card[style="display: block;"], .tool-card:not([style])');
        category.style.display = visibleTools.length > 0 ? 'block' : 'none';
      });
    }

    // Scan operations
    function startScan() {
      if (AppState.scheduledTools.size === 0) {
        alert('No tools scheduled. Please add some tools first.');
        return;
      }

      const scripts = [];
      AppState.scheduledTools.forEach((data, toolKey) => {
        const item = document.querySelector(`.scheduled-item[data-tool="${toolKey}"]`);
        const input = item.querySelector('.item-input');
        const args = input.value.trim().split(/\s+/).filter(arg => arg);
        
        scripts.push({
          tool: toolKey,
          args: args
        });
      });

      // Clear existing output
      clearAllOutput();

      // Update UI
      AppState.isScanning = true;
      document.getElementById('start-scan-btn').disabled = true;
      document.getElementById('stop-scan-btn').disabled = false;

      // Start scan
      fetch('/start', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ scripts })
      })
      .then(response => {
        if (!response.ok) {
          throw new Error(`HTTP ${response.status}: ${response.statusText}`);
        }
        return response.json();
      })
      .then(data => {
        console.log('Scan started:', data);
      })
      .catch(error => {
        console.error('Failed to start scan:', error);
        alert('Failed to start scan: ' + error.message);
        resetScanUI();
      });
    }

    function stopScan() {
      fetch('/stop', { method: 'POST' })
        .then(() => {
          console.log('Scan stopped');
          resetScanUI();
        })
        .catch(error => {
          console.error('Failed to stop scan:', error);
        });
    }

    function resetScanUI() {
      AppState.isScanning = false;
      document.getElementById('start-scan-btn').disabled = false;
      document.getElementById('stop-scan-btn').disabled = true;
    }

    function detectNetwork() {
      const btn = document.getElementById('detect-network-btn');
      btn.disabled = true;
      btn.innerHTML = '<span class="spinner"></span> Detecting...';

      fetch('/local_cidr')
        .then(response => response.json())
        .then(data => {
          if (data.cidr) {
            // Add nmap with detected network
            addScheduledTool('nmap');
            setTimeout(() => {
              addArgumentToTool('nmap', data.cidr);
            }, 100);
            
            alert(`Network detected: ${data.cidr}`);
          } else {
            alert('Failed to detect local network');
          }
        })
        .catch(error => {
          console.error('Network detection failed:', error);
          alert('Network detection failed: ' + error.message);
        })
        .finally(() => {
          btn.disabled = false;
          btn.innerHTML = 'Auto-Detect Network';
        });
    }

    // Scenario management
    function saveScenario() {
      const name = document.getElementById('scenario-name').value.trim();
      if (!name) {
        alert('Please enter a scenario name');
        return;
      }

      if (AppState.scheduledTools.size === 0) {
        alert('No tools to save');
        return;
      }

      const scripts = [];
      AppState.scheduledTools.forEach((data, toolKey) => {
        const item = document.querySelector(`.scheduled-item[data-tool="${toolKey}"]`);
        const input = item.querySelector('.item-input');
        const args = input.value.trim().split(/\s+/).filter(arg => arg);
        
        scripts.push({
          tool: toolKey,
          args: args
        });
      });

      fetch('/save_scenario', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ name, scripts })
      })
      .then(response => response.json())
      .then(data => {
        if (data.status === 'saved') {
          alert(`Scenario "${data.name}" saved successfully`);
          loadScenarios();
        } else {
          alert(`Failed to save scenario: ${data.message}`);
        }
      })
      .catch(error => {
        console.error('Failed to save scenario:', error);
        alert('Failed to save scenario: ' + error.message);
      });
    }

    function loadScenario(event) {
      const scenarioName = event.target.value;
      if (!scenarioName) return;

      fetch(`/load_scenario/${scenarioName}`)
        .then(response => response.json())
        .then(data => {
          if (data.status === 'error') {
            alert(`Failed to load scenario: ${data.message}`);
            return;
          }

          // Clear current tools
          clearAllTools();

          // Load scenario tools
          data.scripts.forEach(script => {
            addScheduledTool(script.tool);
            setTimeout(() => {
              const item = document.querySelector(`.scheduled-item[data-tool="${script.tool}"]`);
              if (item) {
                const input = item.querySelector('.item-input');
                input.value = script.args.join(' ');
              }
            }, 100);
          });

          alert(`Scenario "${scenarioName}" loaded successfully`);
        })
        .catch(error => {
          console.error('Failed to load scenario:', error);
          alert('Failed to load scenario: ' + error.message);
        });
    }

    function loadScenarios() {
      fetch('/list_scenarios')
        .then(response => response.json())
        .then(data => {
          const select = document.getElementById('scenario-list');
          select.innerHTML = '<option value="">-- Load Scenario --</option>';
          
          data.scenarios.forEach(name => {
            const option = document.createElement('option');
            option.value = name;
            option.textContent = name;
            select.appendChild(option);
          });
        })
        .catch(error => {
          console.error('Failed to load scenarios:', error);
        });
    }

    function clearAllTools() {
      AppState.scheduledTools.clear();
      document.querySelectorAll('.scheduled-item').forEach(item => item.remove());
      document.getElementById('drop-placeholder').style.display = 'block';
      
      Object.values(AppState.outputCards).forEach(card => card.remove());
      AppState.outputCards = {};
    }

    function clearAllOutput() {
      Object.values(AppState.outputCards).forEach(card => {
        const content = card.querySelector('.card-content');
        content.innerHTML = '';
      });
    }

    function expandAllOutput() {
      Object.values(AppState.outputCards).forEach(card => {
        const header = card.querySelector('.card-header');
        const body = card.querySelector('.card-body');
        const toggle = card.querySelector('.card-toggle');
        
        body.classList.add('expanded');
        header.classList.add('expanded');
        toggle.textContent = '▼';
      });
    }
  </script>
</body>

</html>